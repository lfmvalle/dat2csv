# C23 DAT2CSV

This script was developed during my Post-Graduation (Master's Degree) in Chemistry to be extensively used in batch calculations.

It parses the numerical results from *DAT* files generated by the **Properties** program of **CRYSTAL23** Quantum Package and generates separed *CSV* files (aiming at spin-polarized solutions).

The structure of the CSV files generated by the script allows these files to be readily imported by OriginLab 2024:

Currently supported result files are:
- Electronic Band Structures (BAND.DAT)
- Density of States (DOSS.DAT)
- Crystal Orbital Hamiltonian Population (COHP.DAT)
- Crystal Orbital Overlap Population (COOP.DAT)

> This script was not tested with CRYSTAL17, but it might work just fine (the file structure is the same in both versions).

# Executing dat2csv
## Installation
>This script was made using Python 3.14, but most of its functionalities are compatible with Python 3.10. <br> You can manually "downgrade" the scripts so it can be executed with Python 3.10, but do it at **your own risk**.

Download all files in [src folder](/src) and use the [main.py](/src/main.py) entry point.
Make sure it has execution permissions.

In Linux systems, you could either call the script using the interpreter (`python3 path_to/main.py`) or by direct execution (`. path_to/main.py`), as long as Python 3.14 is properly installed.

I strongly suggest to create an alias to facilitate calling the script (I will refer to this alias as `dat2csv` from now on).

## Usage
### Basics:
At least one argument pointing to a DAT file must be passed on the script call.

BAND: `$ dat2csv some-band-file.dat` <br> Will parse the contents of ***some-band-file.dat*** file and generate `alpha_band_ev.csv` (and a *beta* file, if spin-polarized).

DOS: `$ dat2csv some-doss-file.dat` <br> Will parse the contents of ***some-doss-file.dat*** file and generate `alpha_dos_ev.csv` (and a *beta* file, if spin-polarized).

COHP: `$ dat2csv some/other/path/cohp-file.dat` <br> Generates the `alpha_cohp_ev.csv` (and *beta*) in the `some/other/path` directory.

COOP: `$ dat2csv ../../some-folder/coop.dat` <br> Generates the `alpha_coop_ev.csv` (and *beta*) in the `../../some-folder/` directory.

All CSV files are generated in the same folder as the input DAT file.

### Chained files:
You can chain many DAT files within the same script call:

`$ dat2csv some/folder/some-band.dat ../another/folder/another-band.dat` <br> Parses `some-band.dat` and generates the `alpha_band_ev.csv` (and *beta*) in the `some/folder/` directory. <br> Parses `another-band.dat` and generates the `alpha_band_ev.csv` (and *beta*) in the `another/folder/` directory.

### Energy units
By default, the script will automatically convert all energy units to eV. If you intend to keep Hartree units, use the ***-h*** parameter:

`$ dat2csv -h some-band-file.dat`
or
`$ dat2csv some-band-file.dat -h some-doss-file.dat`

## File name constraints:
The script is ready-to-go with the default names from the result files generated by CRYSTAL. You can rename these files, as long as you maintain these rules:

- The name MUST contain "*band*", "*doss*", "*cohp*", **OR** "*coop*" (case insensitive);
- The name MUST end with the "*.DAT*" file extension (also case insensitive).

In case of a file name containing two or more of these keywords (e.g., `some-coop-doss-cohp-band.dat`), the first keyword found respecting the order *band* -> *doss* -> *cohp* -> *coop* is validated. In this case, `band` is validated, and the script will try to parse the file as it was a `BAND.DAT` file. This could lead to unexpected errors. Be carefull to not rename a result file like this.

If these requirements are not met, then the script will raise errors.